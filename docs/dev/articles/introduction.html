<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="schtools">
<title>Introduction to schtools • schtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to schtools">
<meta property="og:description" content="schtools">
<meta property="og:image" content="http://www.schlosslab.org/schtools/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">schtools</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Vignettes</h6>
    <a class="dropdown-item" href="../articles/introduction.html">Introduction to schtools</a>
    <a class="dropdown-item" href="../articles/logo.html">logo</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SchlossLab/schtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to schtools</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SchlossLab/schtools/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.schlosslab.org/schtools/">schtools</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="parsing-mothur-output-files">Parsing mothur output files<a class="anchor" aria-label="anchor" href="#parsing-mothur-output-files"></a>
</h2>
<div class="section level3">
<h3 id="taxonomy-files">Taxonomy files<a class="anchor" aria-label="anchor" href="#taxonomy-files"></a>
</h3>
<p>mothur formats taxonomy files as tab-separated values (tsv). You can use <code><a href="../reference/read_tax.html">read_tax()</a></code> to parse the taxonomy data and create separate columns for each taxonomic level.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test.taxonomy"</span>, package <span class="op">=</span> <span class="st">"schtools"</span><span class="op">)</span></span>
<span><span class="va">tax_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tax.html">read_tax</a></span><span class="op">(</span><span class="va">tax_filepath</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tax_dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   otu      otu_label tax_otu_l…¹ label…² kingdom phylum class order family genus</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Otu0001  OTU 1     Bacteroide… &lt;i&gt;Bac… Bacter… Bacte… Bact… Bact… Bacte… Bact…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Otu0003  OTU 3     Porphyromo… &lt;i&gt;Por… Bacter… Bacte… Bact… Bact… Porph… Porp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Otu0004  OTU 4     Porphyromo… &lt;i&gt;Por… Bacter… Bacte… Bact… Bact… Porph… Porp…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Otu00008 OTU 8     Enterobact… &lt;i&gt;Ent… Bacter… Prote… Gamm… Ente… Enter… Ente…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Otu0044  OTU 44    Bacteria (… &lt;i&gt;Bac… Bacter… Bacte… Bact… Bact… Bacte… Bact…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Otu0056  OTU 56    Bacteria (… &lt;i&gt;Bac… Bacter… Bacte… Bact… Bact… Bacte… Bact…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable names ¹​tax_otu_label, ²​label_html</span></span></span></code></pre></div>
<p>The column <code>label_html</code> provides html that correctly italicizes the genus name without italicizing the OTU label. This can be used with <code><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">ggtext::element_markdown()</a></code> to make nice plots:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/" class="external-link">ggtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20220427</span><span class="op">)</span></span>
<span><span class="va">pick_random_bool</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tax_dat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tax_dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">label_html</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample1 <span class="op">=</span> <span class="fu">pick_random_bool</span><span class="op">(</span><span class="op">)</span>, sample2 <span class="op">=</span> <span class="fu">pick_random_bool</span><span class="op">(</span><span class="op">)</span>, sample3 <span class="op">=</span> <span class="fu">pick_random_bool</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"sample"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"sample"</span>, values_to <span class="op">=</span> <span class="st">"presence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">label_html</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"whitesmoke"</span>, fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">presence</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`TRUE` <span class="op">=</span> <span class="st">"#08519C"</span>,</span>
<span>    `FALSE` <span class="op">=</span> <span class="st">"#F0F0F0"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>, axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/italic-genus-1.png" width="700"></p>
<div class="section level4">
<h4 id="pooling-otu-counts-at-different-taxonomic-levels">Pooling OTU counts at different taxonomic levels<a class="anchor" aria-label="anchor" href="#pooling-otu-counts-at-different-taxonomic-levels"></a>
</h4>
<p>A common task is to repeat OTU-level analyses at different taxonomic levels to determine <a href="https://doi.org/10.1128/mbio.03161-21" class="external-link">which resolution is optimal for answering your questions</a>. You’ll need a shared file, generated from clustering sequences into OTUs with mothur, and a corresponding taxonomy file. Take a look at the <a href="https://mothur.org/wiki/" class="external-link">mothur documentation</a> for info on generating these files and performing microbiome analyses.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tax_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tax.html">read_tax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test.taxonomy"</span>, package <span class="op">=</span> <span class="st">"schtools"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">shared_dat</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test.shared"</span>, package <span class="op">=</span> <span class="st">"schtools"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">10</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">15</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> "\t"</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (1): Group</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (14): label, numOtus, Otu0001, Otu0003, Otu0004, Otu00008, Otu0044, Otu0...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="fu"><a href="../reference/pool_taxon_counts.html">pool_taxon_counts</a></span><span class="op">(</span><span class="va">shared_dat</span>, <span class="va">tax_dat</span>, <span class="va">genus</span><span class="op">)</span></span>
<span><span class="co">#&gt; $shared</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 13</span></span></span>
<span><span class="co">#&gt;    label Group numOtus Otu01 Otu02 Otu03 Otu04 Otu05 Otu06 Otu07 Otu08 Otu09</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> genus p1         10     0     0     0     2     0     1     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> genus p10        10     1     0     1     0     1     0     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> genus p2         10     1     1     0     1     0     1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> genus p3         10     0     1     0     1     0     0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> genus p4         10     1     1     1     0     0     0     0     0     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> genus p5         10     1     1     0     1     0     0     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> genus p6         10     1     0     1     1     1     1     0     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> genus p7         10     0     0     0     1     1     0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> genus p8         10     0     1     1     2     0     0     1     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> genus p9         10     0     1     1     2     0     0     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: Otu10 &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tax</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    otu    size genus                                         </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Otu01     5 Bacteroides                                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Otu02     6 Porphyromonadaceae unclassified               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Otu03     5 Enterobacteriaceae unclassified               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Otu04    11 Bacteria unclassified                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Otu05     3 Acinetobacter                                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Otu06     3 Clostridium XlVa                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Otu07     5 Betaproteobacteria unclassified               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Otu08     4 Clostridium XVIII                             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Otu09     7 Candidatus Saccharibacteria unclassified      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Otu10     5 Clostridiales Incertae Sedis XIII unclassified</span></span></code></pre></div>
<p>In this example, <code><a href="../reference/pool_taxon_counts.html">pool_taxon_counts()</a></code> pools the OTU counts in the shared file at the genus level and returns new shared and taxonomy data frames. You can do this for any taxonomic level in your taxonomy data frame.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pool_taxon_counts.html">pool_taxon_counts</a></span><span class="op">(</span><span class="va">shared_dat</span>, <span class="va">tax_dat</span>, <span class="va">phylum</span><span class="op">)</span></span>
<span><span class="co">#&gt; $shared</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;    label  Group numOtus  Otu1  Otu2  Otu3  Otu4  Otu5</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> phylum p1          5     0     0     2     2     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> phylum p10         5     1     3     0     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> phylum p2          5     2     0     1     2     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> phylum p3          5     1     1     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> phylum p4          5     2     1     0     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> phylum p5          5     2     0     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> phylum p6          5     1     2     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> phylum p7          5     0     2     1     1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> phylum p8          5     1     2     2     1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> phylum p9          5     1     2     2     2     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tax</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;   otu    size phylum                     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Otu1     11 Bacteroidetes              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Otu2     13 Proteobacteria             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Otu3     11 Bacteria unclassified      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Otu4     12 Firmicutes                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Otu5      7 Candidatus Saccharibacteria</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="distance-files">Distance files<a class="anchor" aria-label="anchor" href="#distance-files"></a>
</h3>
<p>If you have a distance file saved as a phylip-formatted lower triangle matrix from mothur’s <a href="https://mothur.org/wiki/dist.seqs/" class="external-link"><code>dist.seqs</code></a> command, you can read it into R with <code><a href="../reference/read_dist.html">read_dist()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sample.final.thetayc.0.03.lt.ave.dist"</span>,</span>
<span>    package <span class="op">=</span> <span class="st">"schtools"</span><span class="op">)</span></span>
<span><span class="va">dist_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dist.html">read_dist</a></span><span class="op">(</span><span class="va">dist_filepath</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dist_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   rows      columns   distances</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 104_1_D1  104_1_D0      0.893</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 104_1_D10 104_1_D0      0.254</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 104_1_D10 104_1_D1      0.922</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 104_1_D2  104_1_D0      0.874</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 104_1_D2  104_1_D1      0.109</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 104_1_D2  104_1_D10     0.904</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="r-markdown-helpers-for-scientific-writing">R Markdown helpers for scientific writing<a class="anchor" aria-label="anchor" href="#r-markdown-helpers-for-scientific-writing"></a>
</h2>
<p>When writing scientific papers with R Markdown, we often find ourselves using the same knitr chunk options and miscellaneous helper functions. To use our favorite options like <code>eval=TRUE</code>, <code>echo=FALSE</code>, and others, run <code><a href="../reference/set_knitr_opts.html">set_knitr_opts()</a></code> in the first chunk of your R Markdown document:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1"></a><span class="bn">```{r, include = FALSE}</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="bn">set_knitr_opts()</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="bn">```</span></span></code></pre></div>
<p>This also sets the inline hook to our custom <code><a href="../reference/inline_hook.html">inline_hook()</a></code> function, which automatically formats numbers in a human-readable way and inserts an Oxford comma into lists when needed.</p>
<div class="section level3">
<h3 id="who-doesnt-love-an-oxford-comma">Who doesn’t love an Oxford comma?<a class="anchor" aria-label="anchor" href="#who-doesnt-love-an-oxford-comma"></a>
</h3>
<p>When writing with R Markdown, you may wish to insert a list or vector inline and correctly format it with an Oxford comma. <code><a href="../reference/inline_hook.html">inline_hook()</a></code> uses <code><a href="../reference/paste_oxford_list.html">paste_oxford_list()</a></code> to help you do just that!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cats"</span>, <span class="st">"dogs"</span>, <span class="st">"fish"</span><span class="op">)</span></span></code></pre></div>
<p>Insert the string as inline code with <code>`r `</code>:</p>
<blockquote>
<p><code>`r animals`</code> are the most common pets.</p>
</blockquote>
<p>Rendered output:</p>
<blockquote>
<p>cats, dogs, and fish are the most common pets.</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="human-readable-numbers">Human-readable numbers<a class="anchor" aria-label="anchor" href="#human-readable-numbers"></a>
</h3>
<p><code><a href="../reference/inline_hook.html">inline_hook()</a></code> uses <code>format_numbers()</code> under the hood to automatically format numbers to a human-readable format, rather than display in scientific notation.</p>
<blockquote>
<p>The numbers <code>`r c(1e-04, 1e-05, 1e-06)`</code> are very precise, while <code>`r c(1e04, 1e05, 1e06)`</code> are very large.</p>
</blockquote>
<p>Rendered output:</p>
<blockquote>
<p>The numbers 0.0001, 0.00001, and 0.000001 are very precise. while 10,000, 100,000, and 1,000,000 are very large.</p>
</blockquote>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/kelly-sovacool" class="external-link">Kelly Sovacool</a>, <a href="https://github.com/NLesniak" class="external-link">Nick Lesniak</a>, <a href="https://github.com/pschloss" class="external-link">Patrick Schloss</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
